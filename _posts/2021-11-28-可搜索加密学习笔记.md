---
layout: post
title:  可搜索加密学习笔记
date:   2021-11-28 15:40:35 +0300
image:  1.jpg
tags:   SE
---

> 单关键词搜索、多关键词搜索、连接关键词搜索、模糊关键词搜索
>
> 适应性安全、非适应性安全
>
> 布隆过滤器
>
> 代理重加密、属性加密
>
> 编辑距离
>
> 海明距离
>
> 双线性对（bilinear pairing）
>
> 离散Diffie-Hellman问题（DDH）
>
> 双线性 Diffie-Hellman 问题（BDH）

# 可搜索加密（ SE，searchable encryption ）

可搜索加密问题的提出,源于解决两类可搜索加密的基本问题：① 不可信赖服务器的存储问题；② 不可信赖服务器的路由问题。

![4700-1](D:\blog\TMing-h.github.io\images\4700-1.jpg)

它能实现云端在不解密密文的情况下，完成对密文的检索工作。SE 一般分为如下 4 个阶段：

1. 加密过程。用户使用密钥在本地对明文文件进行加密,并将其上传至服务器；
2. 陷门生成过程。具备检索能力的用户,使用密钥生成待查询关键词的陷门,要求陷门不能泄露关键词的任何信息；
3. 检索过程。服务器以关键词陷门为输入,执行检索算法,返回所有包含该陷门对应关键词的密文文件,要求服务器除了能知道密文文件是否包含某个特定关键词外,无法获得更多信息；
4. 解密过程。用户使用密钥解密服务器返回的密文文件,获得查询结果。

根据密钥类型的不同，SE 可以分为对称可搜索加密（ SSE， symmetric searchable encryption ）和非对称可搜索加密（ ASE，asymmetric searchable encryption ）。二者的应用场景不同，ASE 主要用于 “多对一” 场景，比如多用户邮件场景，例如 Bob, Carol 等多人向 Alice 发送邮件, 这些邮件通过 Alice 的公钥进行加密，Alice 可以根据私钥在邮件系统中进行关键字搜索并解密邮件内容并保证邮件服务器对内容一无所知；而 SSE 主要用来解决 “一对一” 单用户在云环境下的安全问题，即主要应用场景是个人用户将数据加密存储于云服务器, 并能在之后对加密数据进行检索。

<br>

# 可搜索加密的分类（应用模型分类）及解决方案

## 1、单用户（单服务器）模型

用户加密个人文件并将其存储于不可信赖外部服务器。对称可搜索加密 SEE 适用于解决该问题模型。

## 2、多对一（单服务器）模型

多个发送者加密文件后,将其上传至不可信赖外部服务器,以期达到与单个接收者传送数据的目的。非对称可搜索加密使用两种密钥：公钥用于明文信息的加密和目标密文的检索，私钥用于解密密文信息和生成关键词陷门，恰好可以解决该问题模型。

## 3、一对多（单服务器）模型

与多对一模型类似,但为单个发送者将加密文件上传至不可信赖外部服务器。

## 4、多对多（单服务器）模型

在多对一模型的基础上,任意用户都可成为接收者。

对于 3、4 两个模型，非对称加密的特性天然适合这两个场景，但是对称加密由于其开销小，速度快等特点，同样可以通过结合一些其他技术来解决该问题模型。

<br>

# 对称可搜索加密-SSE

SSE 定义在字典 Δ = { W1,W2,…,Wd } 上的对称可搜索加密算法可描述为五元组：
$$
SSE = ( KeyGen,Encrypt,Trapdoor,Search,Decrypt )
$$
其中

1. K=KeyGen(λ)：λ是安全参数，该算法根据安全参数生成加密密钥K。
2. (I,C)=Encrypt(K,D)：D是明文文件集合， D=(D1,D2,…,Dn),Di∈$$2^Δ$$，该算法生成文件索引I密文文件集C=(C1,C2,…,Cn)，部分方案不需要生成索引。
3. TW=Trapdoor(K,W)：其中，W是用户输入需要查询的关键词，该算法生成关键词W对应的陷门TW。
4. D(W)=Search(I,TW)：该算法根据用户输入生成的陷门TW以及文件的索引I进行查找，输出与输入关键词匹配的文件集合D(W)。
5. Di=Decrypt(K,Ci)：用生成的密钥K解密返回的密文文件Ci，生成明文文件Di。

------

<br>

## 典型构造

### 1. SWP 方案

![4700-5](D:\IIE\SSE-team\images\4700-5.jpg)

<br>

### 2. Z-IDX 方案

![4700-6](D:\IIE\SSE-team\images\4700-6.jpg)

<br>

### 3. SSE-1 方案

![4700-7](D:\IIE\SSE-team\images\4700-7.jpg)

<br>

以上三种构造方案就代表了两类 SSE 构建策略：

1. 基于顺序扫描的 SSE 构建策略

​		SWP 方案采用顺序扫描的构建策略，其特点是将明文文件划分为若干个 “单词”，对 “单词” 逐词加密,检索时顺		序扫描整个密文文件,寻找与待检索单词匹配的密文单词。

2. 基于索引的 SSE 构建策略

​		Z-IDX 和 SSE-1 采用基于索引的构建策略,其特点是将 SSE 方案的构造直接划分为两个子过程：构建索引和加		密文件。加密文件用于保护不可信赖服务器上用户数据的隐私，通常采用AES直接加密即可；构建索引用于实		现对密文文件的高效关键词查询。

此外，基于索引的策略又有两种不同的索引构建思想，分别由 Z-IDX 和 SSE-1 反映，即 Z-IDX 采取的是 “文件-关键词” 索引构建思想，构造以文件为基本单位的数据结构( Z-IDX 中为布隆过滤器),检索时,通过该数据结构的操作判断待检索关键词是否存在于某个文件中；② SSE-1 采取的是 “关键词-文件” 索引构建思想，构造以关键词为基本单位的数据结构 (这里为链表) ，检索时，通过该数据结构找到包含待检索关键词的所有文件。

两种不同的索引构建思想也导致了不同的效率（这里考虑关键词检索效率和文件更新效率）：

1）采用 “文件-关键词” 构建思想的 SSE 方案以文件为基本单位，使其在文件更新时只需更新当前使用的数据结构，具有较高的效率。由于检索是以关键词为基本单位进行，要求服务器遍历所有文件的数据结构；

2）采用 “关键词-文件” 构建思想的 SSE 方案处理以关键词为基本操作单位的检索操作时具备较高的效率。但由于文件更新的基本操作单位为文件，使得文件更新时，服务器需重新构建适应更新后状态以关键词为基本单位的索引，造成较大开销。



# 非对称可搜索加密-ASE

**PEKS（public key encryption with keyword search）**
$$
PEKS=(KeyGen,Encrypt,Trapdoor,Test)
$$

1. (*pk*,*sk*)=*KeyGen*(λ)：输入安全参数 λ，输出公钥*pk*和私钥*sk*；
2. *CW*=*Encrypt*(*pk*,*W*)：输入公钥*pk*和关键词*W*，输出关键词密文*CW*；
3. *TW*=*Trapdoor*(*sk*,*W*)：输入私钥*sk*和关键词*W*，输出陷门*TW*；
4. *b*=*Test*(*pk*,*CW*,*TW‘*)：输入公钥*pk*、陷门*TW’*和关键词密文*CW*，根据*W*与*W’*的匹配结果，输出判定值*b*∈ {0,1}.
