---
layout: post
title:  可搜索加密学习笔记
date:   2021-11-28 15:40:35 +0300
image:  1.jpg
tags:   SE
---

> 单关键词搜索、多关键词搜索、连接关键词搜索、模糊关键词搜索
>
> 适应性安全、非适应性安全
>
> ~~布隆过滤器~~
>
> 编辑距离
>
> 海明距离
>
> 双线性对（bilinear pairing）
>
> 离散Diffie-Hellman问题（DDH）
>
> 双线性 Diffie-Hellman 问题（BDH）

# 可搜索加密（ SE，searchable encryption ）

可搜索加密问题的提出,源于解决两类可搜索加密的基本问题：① 不可信赖服务器的存储问题；② 不可信赖服务器的路由问题。

![4700-1](D:\blog\TMing-h.github.io\images\4700-1.jpg)

它能实现云端在不解密密文的情况下，完成对密文的检索工作。SE 一般分为如下 4 个阶段：

1. 加密过程。用户使用密钥在本地对明文文件进行加密,并将其上传至服务器；
2. 陷门生成过程。具备检索能力的用户,使用密钥生成待查询关键词的陷门,要求陷门不能泄露关键词的任何信息；
3. 检索过程。服务器以关键词陷门为输入,执行检索算法,返回所有包含该陷门对应关键词的密文文件,要求服务器除了能知道密文文件是否包含某个特定关键词外,无法获得更多信息；
4. 解密过程。用户使用密钥解密服务器返回的密文文件,获得查询结果。

根据密钥类型的不同，SE 可以分为对称可搜索加密（ SSE， symmetric searchable encryption ）和非对称可搜索加密（ ASE，asymmetric searchable encryption ）。二者的应用场景不同，ASE 主要用于 “多对一” 场景，比如多用户邮件场景，例如 Bob, Carol 等多人向 Alice 发送邮件, 这些邮件通过 Alice 的公钥进行加密，Alice 可以根据私钥在邮件系统中进行关键字搜索并解密邮件内容并保证邮件服务器对内容一无所知；而 SSE 主要用来解决 “一对一” 单用户在云环境下的安全问题，即主要应用场景是个人用户将数据加密存储于云服务器, 并能在之后对加密数据进行检索。

<br>

# 可搜索加密的分类（应用模型分类）及解决方案

## 1、单用户（单服务器）模型

用户加密个人文件并将其存储于不可信赖外部服务器。对称可搜索加密 SEE 适用于解决该问题模型。

## 2、多对一（单服务器）模型

多个发送者加密文件后,将其上传至不可信赖外部服务器,以期达到与单个接收者传送数据的目的。非对称可搜索加密使用两种密钥：公钥用于明文信息的加密和目标密文的检索，私钥用于解密密文信息和生成关键词陷门，恰好可以解决该问题模型。

## 3、一对多（单服务器）模型

与多对一模型类似,但为单个发送者将加密文件上传至不可信赖外部服务器。

## 4、多对多（单服务器）模型

在多对一模型的基础上,任意用户都可成为接收者。

对于 3、4 两个模型，非对称加密的特性天然适合这两个场景，但是对称加密由于其开销小，速度快等特点，同样可以通过结合一些其他技术来解决该问题模型。

<br>

# 对称可搜索加密-SSE

SSE 定义在字典 Δ = { W1,W2,…,Wd } 上的对称可搜索加密算法可描述为五元组：**SSE = ( KeyGen,Encrypt,Trapdoor,Search,Decrypt ) **。

其中

1. K=KeyGen(λ)：λ是安全参数，该算法根据安全参数生成加密密钥K。
2. (I,C)=Encrypt(K,D)：D是明文文件集合， D=(D1,D2,…,Dn),Di∈$$2^Δ$$，该算法生成文件索引I密文文件集C=(C1,C2,…,Cn)，部分方案不需要生成索引。
3. TW=Trapdoor(K,W)：其中，W是用户输入需要查询的关键词，该算法生成关键词W对应的陷门TW。
4. D(W)=Search(I,TW)：该算法根据用户输入生成的陷门TW以及文件的索引I进行查找，输出与输入关键词匹配的文件集合D(W)。
5. Di=Decrypt(K,Ci)：用生成的密钥K解密返回的密文文件Ci，生成明文文件Di。

------

1.搜索语句的表达能力；2.安全性

------

# 非对称可搜索加密-ASE

**PEKS（public key encryption with keyword search）**
$$
PEKS=(KeyGen,Encrypt,Trapdoor,Test)
$$

1. (pk,sk)=KeyGen(λ)：λ是安全参数，该算法根据安全参数生成公钥pk和私钥sk。
2. CW=Encrypt(pk,W)：利用生成的公钥pk和加密文件的关键词W，生成关键词密文CW。
3. TW=Trapdoor(sk,W)：利用生成的私钥sk和用户输入的关键词W，生成关键词W的陷门TW。
4. b=Test(pk,CW,TW)：根据生成的公钥pk、关键词W的陷门TW和关键词密文CW，计算匹配相似度，输出判定值b∈ {0,1}。
